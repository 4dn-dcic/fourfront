{
    "title": "Task",
    "description": "Schema for submitting metadata on the execution of a computational analysis step as part of a workflow run.",
    "id": "/profiles/task.json",
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "required": ["analysis_step"],
    "additionalProperties": false,
    "identifyingProperties": ["uuid", "aliases"],
    "mixinProperties": [
        { "$ref": "mixins.json#/schema_version" },
        { "$ref": "mixins.json#/aliases" },
        { "$ref": "mixins.json#/uuid" },
        { "$ref": "mixins.json#/submitted"},
        { "$ref": "mixins.json#/documents" },
        { "$ref": "mixins.json#/notes"}
    ],
    "properties": {
        "schema_version": {
            "default": "1"
        },
        "title": {
            "title": "Title",
            "description": "The preferred viewable name of the task.",
            "type": "string"
        },
        "description": {
            "title": "Description",
            "description": "A plain text description of the task.",
            "type": "string"
        },
        "task_id": {
            "title": "Task ID",
            "description": "7BG specifies a unique task id for each task run",
            "type": "string"
        },
        "task_platform": {
            "title": "Platform",
            "description": "The platform that the task is run on",
            "type": "string",
            "enum" : [
                "7 bridges",
                "Tibanna"
            ]
        },
        "analysis_step": {
            "title": "Analysis Step",
             "description": "The analysis step that is executed as part of the task",
             "type": "string",
             "linkTo": "AnalysisStep"
        },
        "input_files": {
            "title": "Input files",
            "description": "The files used as input for the task.",
            "type": "array",
            "items": {
                "title": "Input file",
                "description": "A file used as input for the task.",
                "type": "string",
                "linkTo": "File"
            }
        },
        "output_files": {
            "title": "Output files",
            "description": "The files output by the task.",
            "type": "array",
            "items": {
                "title": "Output file",
                "description": "A file output by the task.",
                "type": "string",
                "linkTo": "File"
            }
        },
        "task_parameters": {
            "title": "Task Parameters",
            "description": "The parameters that are used by the analysis step - not all of which are necessarily passed to listed software",
            "type": "array",
            "items": {
                "title": "Parameter",
                "type": "object",
                "additionalProperties": false,
                "properties": {
                    "parameter": {
                        "title": "Parameter name",
                        "description": "the name or flag of the parameter as passed to the software",
                        "type": "string"
                    },
                    "description": {
                        "title": "Description",
                        "description": "Short description of the parameter",
                        "type": "string"
                    },
                    "value": {
                        "title": "Value",
                        "description": "a specified value for the specified parameter as used in a task",
                        "comment": "can we specify either number or string?",
                        "type": "string"
                    }
                }
            }
        },
        "started_running": {
            "title": "Start time",
            "description": "When the task was started",
            "type": "string",
            "format": "date-time"
        },
        "stopped_running": {
            "title": "Finish time",
            "description": "When the task ended",
            "type": "string",
            "format": "date-time"
        },
        "job_status": {
            "title": "Status",
            "type": "string",
            "default": "waiting",
            "enum" : [
                "waiting",
                "running",
                "finished",
                "error"
            ]
        },
        "created_by": {
            "title": "Created by",
            "description": "who created the task - username",
            "type": "string"
        },
        "executed_by": {
            "title": "Executed by",
            "description": "who executed the task - username",
            "type": "string"
        },
        "additional_task_run_details": {
            "title": "Additional Task run details",
            "description": "Additional metadata from the Task Run parsed from Post Run Jsons",
            "comment": "Making this an unspecified 'limitless' property list/dictionary",
            "type": "object",
            "properties": {},
            "additionalProperties": true
        }
    }
}
